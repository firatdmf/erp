{% extends "base.html" %}
{% block content %}

<h2>App Settings</h2>

<div style="background: white; border-radius: 12px; border: 1px solid #e2e8f0; margin-top: 24px;">
    <div style="padding: 20px; border-bottom: 1px solid #e2e8f0;">
        <h3 style="margin: 0; font-size: 16px; font-weight: 600;">Integrations</h3>
        <p style="margin: 4px 0 0; font-size: 13px; color: #64748b;">Manage third-party connections and services.</p>
    </div>

    <div style="padding: 24px;">
        <!-- Google Chat Integration -->
        <div
            style="display: flex; align-items: center; justify-content: space-between; padding-bottom: 24px; border-bottom: 1px solid #f1f5f9;">
            <div style="display: flex; gap: 16px;">
                <div
                    style="width: 48px; height: 48px; background: #f8fafc; border-radius: 10px; display: flex; align-items: center; justify-content: center;">
                    <i class="fab fa-google" style="font-size: 24px; color: #DB4437;"></i>
                </div>
                <div>
                    <h4 style="margin: 0 0 4px; font-size: 15px; font-weight: 500;">Google Account</h4>
                    {% if google_creds %}
                    <p style="margin: 0; font-size: 13px; color: #334155; font-weight: 500;">
                        {% if google_creds.avatar_url %}
                        <img src="{{ google_creds.avatar_url }}" alt="Avatar"
                            style="width: 20px; height: 20px; border-radius: 50%; vertical-align: middle; margin-right: 6px;">
                        {% endif %}
                        {{ google_creds.email|default:"Google Connected" }}
                    </p>
                    <div
                        style="display: inline-flex; align-items: center; gap: 6px; margin-top: 4px; padding: 2px 8px; background: #dcfce7; color: #166534; border-radius: 20px; font-size: 11px; font-weight: 600;">
                        <i class="fas fa-check-circle"></i> Active — Google Chat
                    </div>
                    {% else %}
                    <p style="margin: 0; font-size: 13px; color: #64748b;">Connect your Google account to access Google
                        Chat in Team Messages.</p>
                    {% endif %}
                </div>
            </div>

            <div>
                {% if is_google_connected %}
                <a href="{% url 'authentication:google_disconnect' %}"
                    onclick="return confirm('Are you sure you want to disconnect Google Chat?')"
                    style="text-decoration: none; padding: 8px 16px; background: #fff1f2; color: #e11d48; border: 1px solid #fecdd3; border-radius: 8px; font-size: 13px; font-weight: 600; display: inline-flex; align-items: center; gap: 8px; transition: all 0.2s;">
                    <i class="fas fa-unlink"></i> Disconnect
                </a>
                {% else %}
                <a href="{% url 'authentication:google_login' %}"
                    style="text-decoration: none; padding: 10px 20px; background: white; color: #334155; border: 1px solid #cbd5e1; border-radius: 8px; font-size: 13px; font-weight: 600; display: inline-flex; align-items: center; gap: 8px; transition: all 0.2s; box-shadow: 0 1px 2px rgba(0,0,0,0.05);">
                    <i class="fab fa-google"></i> Connect Google
                </a>
                {% endif %}
            </div>
        </div>

        <!-- Gmail Integration (uses same Google Account) -->
        <div style="display: flex; align-items: center; justify-content: space-between; padding-top: 24px;">
            <div style="display: flex; gap: 16px;">
                <div
                    style="width: 48px; height: 48px; background: #fef2f2; border-radius: 10px; display: flex; align-items: center; justify-content: center;">
                    <i class="fas fa-envelope" style="font-size: 22px; color: #EA4335;"></i>
                </div>
                <div>
                    <h4 style="margin: 0 0 4px; font-size: 15px; font-weight: 500;">Gmail — Mail System</h4>
                    {% if is_google_connected %}
                    <p style="margin: 0; font-size: 13px; color: #334155; font-weight: 500;">
                        <i class="fas fa-envelope" style="font-size: 12px; color: #EA4335; margin-right: 4px;"></i>
                        {{ google_creds.email|default:"Google Connected" }}
                    </p>
                    <div
                        style="display: inline-flex; align-items: center; gap: 6px; margin-top: 4px; padding: 2px 8px; background: #dcfce7; color: #166534; border-radius: 20px; font-size: 11px; font-weight: 600;">
                        <i class="fas fa-check-circle"></i> Active — Send & Receive Emails
                    </div>
                    {% else %}
                    <p style="margin: 0; font-size: 13px; color: #64748b;">Connect your Google account above to enable
                        Gmail integration for sending and receiving emails.</p>
                    {% endif %}
                </div>
            </div>

            <div>
                {% if is_google_connected %}
                <span
                    style="display: inline-flex; align-items: center; gap: 6px; padding: 8px 16px; background: #f0fdf4; color: #166534; border: 1px solid #bbf7d0; border-radius: 8px; font-size: 13px; font-weight: 600;">
                    <i class="fas fa-check-circle"></i> Connected
                </span>
                {% else %}
                <a href="{% url 'authentication:google_login' %}"
                    style="text-decoration: none; padding: 10px 20px; background: white; color: #334155; border: 1px solid #cbd5e1; border-radius: 8px; font-size: 13px; font-weight: 600; display: inline-flex; align-items: center; gap: 8px; transition: all 0.2s; box-shadow: 0 1px 2px rgba(0,0,0,0.05);">
                    <i class="fab fa-google"></i> Connect Google
                </a>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}